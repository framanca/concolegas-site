<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Concolegas · Unirse a sala</title>
  <meta name="description" content="Abre Concolegas para unirte a la sala." />
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; background: #f6f7fb; }
    .wrap { min-height: 100vh; display: grid; place-items: center; padding: 24px; }
    .card { max-width: 520px; width: 100%; background: #fff; padding: 24px; border-radius: 16px; box-shadow: 0 8px 24px rgba(0,0,0,.08); text-align: center; }
    h1 { margin: 0 0 8px; font-size: 22px; }
    p { margin: 0 0 16px; color: #555; }
    .room { font-weight: 700; color: #111; }
    a.btn { display: block; padding: 12px 16px; margin: 8px 0; background: #1a73e8; color: #fff; border-radius: 10px; text-decoration: none; }
    a.btn.secondary { background: #111; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Unirse a la sala</h1>
      <p>Si tienes la app instalada, debería abrirse automáticamente.</p>
      <p id="roomInfo" class="room"></p>

      <a id="openApp" class="btn" href="#">Abrir Concolegas</a>
      <a class="btn" href="https://play.google.com/store/apps/details?id=com.concolegas.app">Descargar para Android</a>
      <a class="btn secondary" href="https://apps.apple.com/app/id6757526238">Descargar para iOS</a>
    </div>
  </div>

  <script>
    (function () {
      var params = new URLSearchParams(window.location.search);
      var screen = params.get('screen') || '';
      var room = params.get('room') || '';
      var password = params.get('password') || '';

      var qs = new URLSearchParams();
      if (screen) qs.set('screen', screen);
      if (room) qs.set('room', room);
      if (password) qs.set('password', password);

      var joinUrl = 'https://concolegas.com/join' + (qs.toString() ? '?' + qs.toString() : '');
      var openApp = document.getElementById('openApp');
      openApp.href = joinUrl;

      var info = document.getElementById('roomInfo');
      if (room) {
        info.textContent = 'Sala: ' + room;
      }

      var ua = navigator.userAgent || navigator.vendor || window.opera;
      var isAndroid = /android/i.test(ua);
      var isIOS = /iPad|iPhone|iPod/.test(ua) && !window.MSStream;

      // Intento abrir la app con el App Link (si está instalada)
      window.location.href = joinUrl;

      // Si no se abre, redirige a la tienda tras 2.5s (solo en móvil)
      setTimeout(function () {
        if (isAndroid) {
          window.location.href = 'https://play.google.com/store/apps/details?id=com.concolegas.app';
        } else if (isIOS) {
          window.location.href = 'https://apps.apple.com/app/id6757526238';
        }
      }, 2500);
    })();
  </script>
</body>
</html>
